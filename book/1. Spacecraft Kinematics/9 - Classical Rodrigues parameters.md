
# 9. Классические параметры Родрига

**Классические параметры Родрига** - это трехкомпонентное представление ориентации, тесно связанное с кватернионами. Они определяются как отношение векторной и скалярной частей кватерниона:

$$
\beta_i=\dfrac{q_i}{q_0},\ i=1, 2, 3,
$$

или в векторной форме:

$$
\overline{\beta} = \text{tg} \dfrac{\Phi}{2} \overline{e},
$$

где $\Phi$ - угол поворота, а $\overline{e}$ - единичный вектор, задающий ось поворота.

Обратное преобразование от классических параметров Родрига к кватерниону имеет вид:

$$
\begin{cases}
q_0 = \dfrac{1}{\sqrt{1 + \overline{\beta}^T \overline{\beta}}}, \\
q_i = \dfrac{\beta_i}{\sqrt{1 + \overline{\beta}^T \overline{\beta}}}.
\end{cases}
$$

## 9.1. Свойства классических параметров Родрига

1) **Однозначность представления.** Каждой ориентации соответствует единственный вектор $\overline{\beta}$​. Это напрямую следует из определения:

$$\beta_i = \dfrac{-q_i}{-q_0} = \dfrac{q_i}{q_0}.$$
   
   Т.е. обратный кватернион соответствует тому же вектору классических параметров Родрига.
   
2) **Удобство линейной аппроксимации.** При небольших значениях угла поворота $\Phi$ можно использовать приближение:

$$
\overline{\beta} \approx \dfrac{\Phi}{2} \overline{e}.
$$

   Это делает представление удобным для анализа малых отклонений.

3) **Неопределенность.** При $q_0 = 0$, т.е. при повороте на $180^{\circ}$ - длина вектора $\overline{\beta}$ стремится к бесконечности, что приводит к вырождению параметров.

## 9.2. Связь МНК с классическими параметрами Родрига

Ориентация, заданная вектором $\overline{\beta}$​, может быть представлена матрицей направляющих косинусов $\textbf{C}$, вычисляемой по формуле:

$$
\textbf{C} = 
\dfrac{1}{1 + \overline{\beta}^T\overline{\beta}}
\begin{pmatrix}
	1 + \beta_1^2 - \beta_2^2 - \beta_3^2 & 2 (\beta_1 \beta_2 + \beta_3) & 2 (\beta_1 \beta_3 - \beta_2) \\
	2 (\beta_1 \beta_2 - \beta_3) & 1 - \beta_1^2 + \beta_2^2 - \beta_3^2 & 2 (\beta_2 \beta_3 + \beta_1) \\
	2 (\beta_1 \beta_3 + \beta_2) & 2 (\beta_2 \beta_3 - \beta_1) & 1 - \beta_1^2 - \beta_2^2 + \beta_3^2 & \\
\end{pmatrix}.
$$

Эта матрица обладает следующим интересным свойством:

$$
\textbf{C}(\overline{\beta})^{-1} = \textbf{C}(\overline{\beta})^T = \textbf{C}(-\overline{\beta}).
$$

## 9.3. Связь классических параметров Родрига с МНК

Если известна матрица $\textbf{C}$, классические параметры Родрига можно восстановить по формуле:

$$
\overline{\beta} = \dfrac{1}{\zeta^2}
\begin{pmatrix}
	\textbf{C}_{23} - \textbf{C}_{32} \\
	\textbf{C}_{31} - \textbf{C}_{13} \\
	\textbf{C}_{12} - \textbf{C}_{21} \\
\end{pmatrix},
$$

где $\zeta = \sqrt{\text{tr}[\textbf{C}] + 1} = 2q_0$,

$\text{tr}[\textbf{C}] = \textbf{C}_{11} + \textbf{C}_{22} + \textbf{C}_{33}$ - след матрицы $\textbf{C}$.

## 9.4. Сложение поворотов

Пусть заданы два последовательных поворота, описываемых векторами $\overline{\beta}'$ и $\overline{\beta}''$. Тогда результирующий поворот $\overline{\beta}$ определяется следующим выражением:

$$
\overline{\beta} = \dfrac{\overline{\beta}' + \overline{\beta}'' - \overline{\beta}'' \times \overline{\beta}'}{1 - \overline{\beta}'' \cdot \overline{\beta}'},
$$

где $\overline{\beta}'' \times \overline{\beta}'$ - векторное произведение двух векторов,

$\overline{\beta}'' \cdot \overline{\beta}'$ - их скалярное произведение.

При сложении поворотов необходимо учитывать возможную неопределенность. Например, если выполняется два последовательных поворота на $90^{\circ}$ вокруг одной и той же оси, то произойдет деление на ноль.

Для малых углов поворота справедливо приближение:

$$\beta \approx \beta' + \beta''.$$

Сложение поворотов также можно определить через перемножение соответствующих **МНК**.

## 9.5. Кинематические уравнения

Связь между угловой скоростью вращения космического аппарата и производной вектора классических параметров Родрига задается следующим образом:

$$
\dot{\overline{\beta}} = 
\dfrac{1}{2}
\begin{pmatrix}
	1 + \beta_1^2 & \beta_1 \beta_2 - \beta_3 & \beta_1 \beta_3 + \beta_2 \\
	\beta_1 \beta_2 + \beta_3 & 1 + \beta_2^2 & \beta_2 \beta_3 - \beta_1 \\
	\beta_1 \beta_3 - \beta_2 & \beta_2 \beta_3 + \beta_1 & 1 + \beta_3^2 \\
\end{pmatrix}
\overline{\omega}^{\text{B}}_{\text{B}/\text{I}}.
$$

В отличие от кинематических уравнений для кватернионов, данная система нелинейна по параметрам $\beta_1,\ \beta_2,\ \beta_3$. При этом уравнение не содержит явного деления на ноль. Тем не менее, при приближении угла поворота $\Phi$ к $180^{\circ}$, значения компонентов $\overline{\beta}$ стремительно возрастают, что может привести к численной нестабильности.

## 9.6. Преобразование Кейли

Преобразование Кейли устанавливает связь между ортогональной матрицей $\textbf{C}$ (с определителем $+1$) и кососимметричной матрицей $\textbf{Q}$. Оно записывается следующим образом:

$$
\textbf{Q} = (\textbf{I} + \textbf{C})^{-1}(\textbf{I} - \textbf{C}) = (\textbf{I} - \textbf{C})(\textbf{I} + \textbf{C})^{-1},
$$

или в обратной форме:

$$
\textbf{C} = (\textbf{I} + \textbf{Q})^{-1}(\textbf{I} - \textbf{Q}) = (\textbf{I} - \textbf{Q})(\textbf{I} + \textbf{Q})^{-1},
$$

где $\textbf{I}$ - единичная матрица.

Если в качестве $\textbf{С}$ взять матрицу направляющих косинусов, то соответствующая матрица $\textbf{Q}$ зависит только от классических параметров Родрига:

$$
\textbf{Q} = 
\begin{pmatrix}
	0 & -\beta_3 & \beta_2 \\ \beta_3 & 0 & -\beta_1 \\ -\beta_2 & \beta_1 & 0
\end{pmatrix}.
$$

Это позволяет выразить матрицу поворота $\textbf{C}$ в компактной форме через вектор $\overline{\beta}$​, обеспечивая более элегантное аналитическое представление.

>На практике преобразование Кейли может быть полезно при решении кинематических уравнений, описывающих эволюцию **МНК** во времени. Оно позволяет сократить вычисления: вместо интегрирования всех 9 элементов матрицы достаточно отслеживать изменение лишь трех параметров.

## 9.7. Заключение

Классические параметры Родрига представляют собой компактный и интуитивно понятный способ описания ориентации с использованием всего трех параметров. Их ключевыми достоинствами являются простота и хорошая линеаризуемость при малых углах поворота, что делает их удобными для анализа и численного моделирования вблизи положения равновесия.

Основным недостатком является вырождение при угле поворота $\Phi = 180^{\circ}$, когда параметры стремятся к бесконечности. Это ограничивает их применение в задачах с произвольными углами поворота.

На практике классические параметры Родрига нередко уступают место **модифицированным параметрам Родрига**, которые лишены указанного недостатка. Их мы рассмотрим в следующей главе.
